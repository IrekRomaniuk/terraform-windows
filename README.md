##Â Example: Running commands via WinRM on a Windows Virtual Machine

[terraform](https://github.com/terraform-providers/terraform-provider-azurerm/tree/master/examples/virtual-machines/provisioners/windows)


export sa_name=sta360spokenetwestus
export sa_rg=net-spoke-westus-prod-automation
export sa_loc=eastus
export sa_key=g4y15BNmE1TUFOoCrebsbPa2Axg1Xf3vK3G+k8FeFD/Z9mM2C0x/Fvhu3VGl76KiQkbEDi4ZnTH3rdlVccBoYQ==
export tf_name=tfstate-orion-state

```
terraform init
terraform init -backend-config="storage_account_name=$sa_name" -backend-config="container_name=$tf_name" -backend-config="access_key=$sa_key"  -backend-config="key=codelab.microsoft.tfstate"
terraform import azurerm_resource_group.mygroup /subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/myresourcegroup
terraform plan -var-file=orion.tfvars -out out.plan
terraform apply out.plan
terraform destroy -var-file=orion.tfvars
terraform show
```
```
azurerm_virtual_machine.example (remote-exec): Connecting to remote host via SSH...
azurerm_virtual_machine.example (remote-exec):   Host: 10.4.8.4
azurerm_virtual_machine.example (remote-exec):   User: azureuser
azurerm_virtual_machine.example (remote-exec):   Password: true
azurerm_virtual_machine.example (remote-exec):   Private key: false
azurerm_virtual_machine.example (remote-exec):   Certificate: false
azurerm_virtual_machine.example (remote-exec):   SSH Agent: false
azurerm_virtual_machine.example (remote-exec):   Checking Host Key: false
azurerm_virtual_machine.example: Still creating... [13m10s elapsed]


Error: timeout - last error: dial tcp 10.4.8.4:5986: i/o timeout
```

This example provisions a Virtual Machine running Windows Server 2016 with a Public IP Address and [runs a `remote-exec` provisioner](https://www.terraform.io/docs/provisioners/remote-exec.html) via WinRM.

Notes:

- The files involved in this example are split out to make it easier to read, however all of the resources could be combined into a single file if needed.
- The certificate used for WinRM is generated by Azure KeyVault and then installed on the VM; as such the certificate in this example is self-signed, which may not be desirable in a real-world environment.
